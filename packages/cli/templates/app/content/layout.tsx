/**
 * Content Module Layout
 *
 * Provides a content management shell with sidebar collection navigation,
 * header bar, and main content area. Wraps all /content/* pages.
 *
 * Generated by @buildpad/cli
 */

"use client";

import React from 'react';
import { usePathname, useRouter } from 'next/navigation';
import { ContentLayout } from '@/components/ui/content-layout';
import { ContentNavigation } from '@/components/ui/content-navigation';
import { useCollections } from '@/lib/buildpad/hooks';

export default function ContentModuleLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  const router = useRouter();
  const pathname = usePathname();

  // Extract current collection from URL: /content/[collection]/...
  const segments = pathname.split('/');
  const currentCollection = segments.length > 2 ? segments[2] : undefined;

  const {
    rootCollections,
    activeGroups,
    toggleGroup,
    showHidden,
    setShowHidden,
    hasHiddenCollections,
    showSearch,
    dense,
    loading,
  } = useCollections({ currentCollection });

  return (
    <ContentLayout
      breadcrumbs={[{ label: 'Content', href: '/content' }]}
      sidebar={
        <ContentNavigation
          rootCollections={rootCollections}
          activeGroups={activeGroups}
          onToggleGroup={toggleGroup}
          currentCollection={currentCollection}
          onNavigate={(collection) => router.push(`/content/${collection}`)}
          showHidden={showHidden}
          onToggleHidden={() => setShowHidden(!showHidden)}
          hasHiddenCollections={hasHiddenCollections}
          showSearch={showSearch}
          dense={dense}
          loading={loading}
        />
      }
    >
      {children}
    </ContentLayout>
  );
}
